<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confirm Purchase</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <a href="index.html" class="menu-item">ğŸ  Home</a>
  <a href="data.html" class="menu-item">ğŸ“¡ Buy Data</a>
  <a href="wallet.html" class="menu-item">ğŸ’° Wallet</a>
  <a href="transactions.html" class="menu-item">ğŸ“„ History</a>
  <a href="profile.html" class="menu-item">ğŸ‘¤ Profile</a>
</div>

<div class="container">

  <div class="card">
    <h2>Confirm Purchase</h2>
    <p id="details"></p>

    <input id="phone" type="tel" placeholder="Enter phone number" style="width:100%;padding:12px;border-radius:12px;border:none;margin-top:12px;">

    <button onclick="confirmOrder()" style="
      margin-top:14px;
      width:100%;
      padding:12px;
      border-radius:14px;
      border:none;
      background:#00eaff;
      font-weight:bold;
      cursor:pointer;
    ">Confirm Purchase</button>
  </div>

</div>

<script>
const params = new URLSearchParams(window.location.search);
const network = params.get('network');
const bundle = params.get('bundle');
const price = params.get('price');

document.getElementById('details').innerHTML =
  `<strong>Network:</strong> ${network}<br>
   <strong>Bundle:</strong> ${bundle}<br>
   <strong>Price:</strong> GHS ${price}`;

function confirmOrder(){
  const phone = document.getElementById('phone').value;

  if(phone.length < 9){
    alert("Enter a valid phone number");
    return;
  }

  // Direct call to your data API
  fetch("https://s5HX8RmBLOe2WpmQdu0WAYS9z302", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer sk_test_0b5ad6ecb17aa96fd58fbfad6660fbe56351d2ad"
    },
    body: JSON.stringify({
      network: network,
      bundle: bundle,
      phone: phone
    })
  })
  .then(res => res.json())
  .then(data => {
    if(data.success){
      alert("âœ… Order submitted successfully! Data will be delivered shortly.");
    } else {
      alert("âŒ Order failed. Please try again.");
      console.log(data);
    }
  })
  .catch(err => {
    alert("âŒ Order failed. Please try again.");
    console.log(err);
  });
}
</script>

</body>
</html>
