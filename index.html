<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Samba531 Data</title>
<style>
body {
  margin:0;
  font-family: 'Arial', sans-serif;
  background:#f4f4f4;
  color:#333;
}
header{
  background:#0073e6;
  color:white;
  padding:20px;
  text-align:center;
}
header h1{
  margin:0;
  font-size:26px;
}
.container{
  max-width:500px;
  margin:20px auto;
}
.wallet-section, .card{
  background:white;
  border-radius:10px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  text-align:center;
}
.wallet-section input, .wallet-section button, .card button{
  width:90%;
  padding:12px;
  margin:5px 0;
  border-radius:5px;
  border:none;
  font-size:16px;
  cursor:pointer;
}
.wallet-btn{
  background:#198754;
  color:white;
}
.balance{
  font-size:18px;
  margin-bottom:10px;
}
.cards .card h2{
  margin:5px 0;
}
.network-btn{
  padding:10px 15px;
  margin:5px 0;
  border:none;
  border-radius:5px;
  font-weight:bold;
  cursor:pointer;
  width:90%;
  font-size:16px;
}
.mtn{background:#ffc107;color:#000;}
.airteltigo{background:#0dcaf0;color:#fff;}
.telecel{background:#dc3545;color:#fff;}
.history-section{
  background:white;
  padding:15px;
  border-radius:10px;
  margin-top:20px;
  text-align:left;
}
.history-section h3{
  margin-top:0;
}
.transaction{
  border-bottom:1px solid #ccc;
  padding:5px 0;
}
</style>
</head>
<body>

<header>
<h1>Samba531 Data</h1>
<p>Buy your mobile data instantly!</p>
</header>

<div class="container">

<!-- Wallet Section -->
<div class="wallet-section">
<div class="balance" id="walletBalance">Wallet Balance: GHS 0</div>
<input type="number" id="topupAmount" placeholder="Enter amount to top up">
<button class="wallet-btn" id="topupBtn">Top Up Wallet</button>
</div>

<!-- Data Bundle Cards -->
<div class="cards">
<div class="card" data-bundle="1GB">
<h2>1GB</h2>
<p>Price: GHS 6</p>
<button class="network-btn mtn">MTN</button>
<button class="network-btn airteltigo">AirtelTigo</button>
<button class="network-btn telecel">Telecel</button>
</div>

<div class="card" data-bundle="2GB">
<h2>2GB</h2>
<p>Price: GHS 12</p>
<button class="network-btn mtn">MTN</button>
<button class="network-btn airteltigo">AirtelTigo</button>
<button class="network-btn telecel">Telecel</button>
</div>

<div class="card" data-bundle="3GB">
<h2>3GB</h2>
<p>Price: GHS 17</p>
<button class="network-btn mtn">MTN</button>
<button class="network-btn airteltigo">AirtelTigo</button>
<button class="network-btn telecel">Telecel</button>
</div>

<div class="card" data-bundle="4GB">
<h2>4GB</h2>
<p>Price: GHS 22</p>
<button class="network-btn mtn">MTN</button>
<button class="network-btn airteltigo">AirtelTigo</button>
<button class="network-btn telecel">Telecel</button>
</div>

<div class="card" data-bundle="5GB">
<h2>5GB</h2>
<p>Price: GHS 29</p>
<button class="network-btn mtn">MTN</button>
<button class="network-btn airteltigo">AirtelTigo</button>
<button class="network-btn telecel">Telecel</button>
</div>
</div>

<!-- Transaction History -->
<div class="history-section" id="historySection">
<h3>Transaction History</h3>
<div id="historyList">No transactions yet.</div>
</div>

</div>

<script src="https://js.paystack.co/v1/inline.js"></script>
<script>
let walletBalance = 0;
let transactions = [];

function updateWallet(amount){
  walletBalance = amount;
  document.getElementById("walletBalance").textContent = `Wallet Balance: GHS ${walletBalance}`;
}

function updateHistory(){
  const container = document.getElementById("historyList");
  if(transactions.length === 0){ container.innerHTML = 'No transactions yet.'; return; }
  container.innerHTML = '';
  transactions.slice().reverse().forEach(tr=>{
    const div = document.createElement('div');
    div.className = 'transaction';
    div.textContent = `[${tr.date}] ${tr.type} - ${tr.details} - GHS ${tr.amount}`;
    container.appendChild(div);
  });
}

const bundlePrices = { "1GB":6, "2GB":12, "3GB":17, "4GB":22, "5GB":29 };

// Wallet Top-up
document.getElementById("topupBtn").addEventListener("click", ()=>{
  const amount = Number(document.getElementById("topupAmount").value);
  if(!amount){ alert("Enter a valid amount"); return; }

  var handler = PaystackPop.setup({
    key: 'pk_test_36e29f5351329fb6632114ba263089ecb14608f0',
    email: 'customer@samba531.com',
    amount: amount * 100,
    currency: 'GHS',
    callback: function(response){
      fetch("https://YOUR_BACKEND_URL/verify", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({ reference: response.reference, amount })
      })
      .then(r=>r.json())
      .then(d=>{
        if(d.success){
          walletBalance += amount;
          updateWallet(walletBalance);
          transactions.push({ type: 'Top-Up', details:'Wallet Top-up', amount, date:new Date().toLocaleString() });
          updateHistory();
          alert('Wallet funded!');
        } else alert('Payment verification failed.');
      });
      document.getElementById("topupAmount").value='';
    },
    onClose:function(){ alert('Payment cancelled'); }
  });
  handler.openIframe();
});

// Bundle Purchase
document.querySelectorAll('.network-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const card = btn.closest('.card');
    const bundle = card.getAttribute('data-bundle');
    const network = btn.textContent;
    const price = bundlePrices[bundle];
    if(walletBalance < price){ alert(`Insufficient balance. Top-up GHS ${price-walletBalance}`); return; }

    fetch("https://YOUR_BACKEND_URL/order",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({ network, bundle, price, phone: "233531766320" })
    })
    .then(r=>r.json())
    .then(d=>{
      if(d.success){
        walletBalance -= price;
        updateWallet(walletBalance);
        transactions.push({ type:'Purchase', details: `${bundle} ${network}`, amount: price, date: new Date().toLocaleString() });
        updateHistory();
        alert('Order successful!');
      } else alert('Order failed!');
    });
  });
});
</script>
</body>
  </html>
